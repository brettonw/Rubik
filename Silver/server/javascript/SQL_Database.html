<script language="javascript" runat="server">
	//--------------------------------------------------------------------------
	// open a catalog
	//--------------------------------------------------------------------------
	function Open_SQL_Database ()
	{
		this.connection.Open (this.database_server);
	}

	//--------------------------------------------------------------------------
	// close a catalog
	//--------------------------------------------------------------------------
	function Close_SQL_Database ()
	{
		this.connection.Close ();
	}

	//--------------------------------------------------------------------------
	// perform an SQL query, and return a record set
	//--------------------------------------------------------------------------
	function Query_SQL_Database (query)
	{
		return this.connection.Execute (query);
	}

	//--------------------------------------------------------------------------
	// SQL_Database constructor
	//--------------------------------------------------------------------------
	function SQL_Database (server, user, password, catalog)
	{
		// create the ado connection object
		this.connection = Server.CreateObject ('ADODB.Connection');

		// set the basic connection string we will use when opening catalogs
		//this.database_server = "Provider=SQLOLEDB;User ID=" + user + ";Password=\"" + password + "\";Data Source=" + server + ";Initial Catalog=" + catalog;
		//this.database_server = "Driver={SQL Server};SERVER=" + server + ";DATABASE=" + catalog + "; UID=" + user + ";PwWD" + password + ";";
		this.database_server = "DSN=Accounting;DATABASE=" + catalog + "; UID=" + user + ";PwWD" + password + ";";

		// set the methods of the clase
		this.Open = Open_SQL_Database;
		this.Close = Close_SQL_Database;
		this.Query = Query_SQL_Database;

		// open the catalog requested
		this.Open ();
	}

	//--------------------------------------------------------------------------
</script>