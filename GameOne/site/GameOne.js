"use strict";var Vector2d=function(){var b=Object.create(null);var c=function(d,f){var e=Object.create(b);e.x=d;e.y=f;return e};b.make=function(d){return c(d[0],d[1])};b.xy=function(d,e){return c(d,e)};b.v=function(d){return c(d.x,d.y)};b.zero=function(){return c(0,0)};b.one=function(){return c(1,1)};b.add=function(d){return c(this.x+d.x,this.y+d.y)};b.subtract=function(d){return c(this.x-d.x,this.y-d.y)};b.scale=function(d){return c(this.x*d,this.y*d)};b.dot=function(d){return(this.x*d.x)+(this.y*d.y)};b.cross=function(d){return(this.x*d.y)-(this.y*d.x)};b.normSq=function(){return this.dot(this)};b.norm=function(){return Math.sqrt(this.normSq())};b.normalized=function(){return this.Scale(1/this.norm(a))};return b}();var Thing=function(){var b=Object.create(null);b.init=function(){this.oneOverMoment=0;this.spinPosition=0;this.spinVelocity=0;this.torque=0;this.oneOverMass=0;this.position=Vector2d.zero();this.velocity=Vector2d.zero();this.force=Vector2d.zero();this.mediumDensity=-0.05;return this};b.integrate=function(c){this.force=this.force.add(this.velocity.scale(this.mediumDensity));this.torque=this.torque+(this.spinVelocity*this.mediumDensity);var f=this.force.scale(this.oneOverMass*c);this.force=Vector2d.zero();var d=this.torque*(this.oneOverMoment*c);this.torque=0;this.position=this.position.add((f.scale(0.5).add(this.velocity)).scale(c));this.spinPosition=this.spinPosition+(((d*0.5)+this.spinVelocity)*c);this.velocity=this.velocity.add(f);this.spinVelocity=this.spinVelocity+d;var e=Math.PI*2;while(this.spinPosition>=e){this.spinPosition-=e}while(this.spinPosition<0){this.spinPosition+=e}};b.applyForce=function(c){this.force=this.force.add(c)};b.applyTorque=function(c){this.torque+=c};b.makeBallGeometry=function(d,c){var e=Math.PI*c*c;var f=(e*c*c)/2;this.oneOverMass=1/e;this.oneOverMoment=1/f;this.svg=d.append("circle").attr("stroke-width",2/scale).attr("fill","red").attr("fill-opacity","1.0").attr("stroke","black").attr("stroke-opacity","1.0").attr("r",c)};b.makePolygonGeometry=function(d,j){var j=[Vector2d.xy(0,0),Vector2d.xy(-0.05,0.05),Vector2d.xy(0.1,0),Vector2d.xy(-0.05,-0.05)];var g=j[0].x+","+j[0].y;for(var f=1;f<j.length;++f){g+=" "+j[f].x+","+j[f].y}this.svg=d.append("polygon").attr("stroke-width",2/scale).attr("fill","red").attr("fill-opacity","1.0").attr("stroke","black").attr("stroke-opacity","1.0").attr("stroke-linejoin","round").attr("points",g);var c=0.1;var e=Math.PI*c*c;var h=(e*c*c)/2;this.oneOverMass=1/e;this.oneOverMoment=1/h};b.update=function(c){this.integrate(c);this.svg.attr("transform","translate("+this.position.x+","+this.position.y+") rotate("+this.spinPosition+", 0.0, 0.0)")};return b}();var Ship=function(){var b=Object.create(Thing);b.init=function(){this.engines=Vector2d.zero();return Object.getPrototypeOf(Ship).init.call(this)};b.update=function(e){var g=(this.spinPosition*Math.PI)/180;var d=Vector2d.xy(Math.cos(g),Math.sin(g));var f=d.scale(0.01);var c=0.01;this.applyForce(f);this.applyTorque(c);Object.getPrototypeOf(Ship).update.call(this,e)};return b}();var scale=1;function initPage(){var n=d3.select("#display");var j=n.append("svg").attr("class","gameDisplay");j.style("opacity",0.000001).transition().duration(1000).style("opacity",1);j.append("rect").attr("class","gameBackground").attr("width","100%").attr("height","100%");var b=j.append("g").attr("class","gameDisplay");j.call(d3.behavior.zoom().translate([0,0]).scale(1).scaleExtent([0.125,8]).on("zoom",function(){b.attr("transform","translate("+d3.event.translate[0]+","+d3.event.translate[1]+") scale("+d3.event.scale+")")}));j=b.append("g").attr("class","gameDisplay");var p=n[0][0].clientWidth;var c=n[0][0].clientHeight;scale=Math.min(p,c);j.attr("transform","translate("+(p/2)+","+(c/2)+") scale("+scale+","+-scale+")");j=j.append("g").attr("class","gameDisplay");var h=[0];var d;var k;for(var g=1;g<25;++g){var o=0.05*g;d=-o;k=o;h=[d].concat(h).concat([k])}j.selectAll(".xTicks").data(h).enter().append("line").attr("class","xTicks").attr("x1",function(i){return i}).attr("y1",d).attr("x2",function(i){return i}).attr("y2",k).attr("stroke","rgba(0, 0, 0, 0.20)").attr("stroke-width",1/scale);j.selectAll(".yTicks").data(h).enter().append("line").attr("class","yTicks").attr("x1",d).attr("y1",function(i){return i}).attr("x2",k).attr("y2",function(i){return i}).attr("stroke","rgba(0, 0, 0, 0.20)").attr("stroke-width",1/scale);var e=Object.create(Ship).init();e.makePolygonGeometry(j,{});var l=Object.create(Ship).init();l.makeBallGeometry(j,0.05);l.position=Vector2d.xy(-0.5,-0.5);var m=1/20;var f=setInterval(function(){e.update(m);l.update(m)},1000*m)};